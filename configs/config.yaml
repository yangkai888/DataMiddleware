# 数据中间件配置文件

# 服务器配置
server:
  # 服务器环境: dev, test, prod
  env: dev
  # HTTP服务器配置
  http:
    host: "0.0.0.0"
    port: 8080
    read_timeout: 30s
    write_timeout: 30s
    max_header_bytes: 1048576
# TCP服务器配置
tcp:
  host: "0.0.0.0"
  port: 9090
  max_connections: 10000
  read_timeout: 30s
  write_timeout: 30s
  debug: true  # 开发模式下显示详细调试信息

# 日志配置
logger:
  level: "info"  # debug, info, warn, error
  format: "json" # json, console
  output: "file" # stdout, file
  file:
    path: "logs/datamiddleware.log"
    max_size: 100  # MB
    max_age: 30    # days
    max_backups: 10
    compress: true

# 数据库配置
database:
  # 主数据库
  primary:
    driver: "mysql" # mysql, oracle
    host: "localhost"
    port: 3306
    username: "root"
    password: "MySQL@123456"
    database: "datamiddleware"
    charset: "utf8mb4"
    max_open_conns: 100
    max_idle_conns: 10
    conn_max_lifetime: 300s
  # 从数据库 (可选)
  replica:
    - driver: "mysql"
      host: "localhost"
      port: 3307
      username: "root"
      password: "password"
      database: "datamiddleware"
      charset: "utf8mb4"
      max_open_conns: 50
      max_idle_conns: 5
      conn_max_lifetime: 300s

# Redis缓存配置
redis:
  host: "localhost"
  port: 6379
  password: ""
  db: 0
  pool_size: 10
  min_idle_conns: 2
  conn_max_lifetime: 300s
  read_timeout: 3s
  write_timeout: 3s

# 缓存配置
cache:
  l1:  # L1本地缓存配置
    enabled: true
    shards: 1024
    life_window: 10m
    clean_window: 5m
    max_entries_in_window: 600000
    max_entry_size: 500
    verbose: true
    hard_max_cache_size: 8192
  l2:  # L2 Redis缓存配置
    enabled: true
    host: "localhost"
    port: 6379
    password: ""
    db: 0
    pool_size: 10
    min_idle_conn: 2
    dial_timeout: 5s
    read_timeout: 3s
    write_timeout: 3s

# JWT配置
jwt:
  secret: "your-secret-key-change-in-production"
  expire: 86400  # token过期时间(秒)

# 游戏路由配置
games:
  - id: "game1"
    name: "游戏1"
    enabled: true
    tcp_port: 9101
    http_prefix: "/api/game1"
  - id: "game2"
    name: "游戏2"
    enabled: true
    tcp_port: 9102
    http_prefix: "/api/game2"

# 监控配置
monitor:
  enabled: true
  port: 9091
  path: "/metrics"

# 健康检查配置
health:
  enabled: true
  path: "/health"
  check_interval: 30s
